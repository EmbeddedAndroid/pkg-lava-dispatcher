#!/usr/bin/python
import json
from lava.actions import get_all_cmds
import sys

with open(sys.argv[1]) as fd:
    jobfile = json.loads(fd.read())

lava_commands = get_all_cmds()

target = jobfile['target']
for cmd in jobfile['actions']:
    try:
        params = cmd['parameters']
    except KeyError:
        params = {}
    step = lava_commands[cmd['command']](target)
    step.run(**params)
